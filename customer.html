<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>SANGHX ‚Ä¢ Gourmet App</title>

<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;700;800&display=swap" rel="stylesheet">
<link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">

<style>
  :root {
    --primary: #FF4B3A; /* Vibrant Orange-Red */
    --dark: #121212;
    --gray: #F5F5F8;
    --white: #ffffff;
    --shadow-soft: 0 10px 30px -10px rgba(0,0,0,0.08);
    --glass: rgba(255, 255, 255, 0.85);
    --glass-border: 1px solid rgba(255, 255, 255, 0.5);
  }

  * { margin:0; padding:0; box-sizing:border-box; font-family:'Outfit', sans-serif; -webkit-tap-highlight-color:transparent; }
  body { background: var(--gray); color: var(--dark); padding-bottom: 120px; overflow-x: hidden; }

  /* --- HEADER --- */
  .header {
    background: var(--glass);
    backdrop-filter: blur(15px);
    -webkit-backdrop-filter: blur(15px);
    position: sticky; top: 0; z-index: 100;
    padding: 15px 20px;
    border-bottom: var(--glass-border);
    display: flex; justify-content: space-between; align-items: center;
    box-shadow: 0 4px 20px rgba(0,0,0,0.03);
  }
  .logo { font-size: 24px; font-weight: 800; color: var(--dark); letter-spacing: -0.5px; }
  .logo span { color: var(--primary); }
  
  /* --- TICKER --- */
  .ticker-wrap {
    background: var(--dark); color: white; overflow: hidden; height: 34px; display: flex; align-items: center;
  }
  .ticker { display: inline-block; white-space: nowrap; animation: scroll 20s linear infinite; }
  .ticker span { padding: 0 30px; font-size: 12px; font-weight: 600; letter-spacing: 0.5px; text-transform: uppercase; }
  @keyframes scroll { 0%{transform:translateX(0);} 100%{transform:translateX(-100%);} }

  .container { padding: 20px; max-width: 600px; margin: 0 auto; }

  /* --- HERO BANNER (AUTO SLIDER) --- */
  .hero-banner {
    width: 100%; height: 180px; border-radius: 24px; margin-bottom: 20px; 
    overflow: hidden; position: relative; box-shadow: var(--shadow-soft);
  }
  .hero-img { 
    width: 100%; 
    height: 100%; 
    object-fit: cover; 
    animation: zoom 10s infinite alternate; 
    transition: opacity 0.3s ease-in-out;
  }
  @keyframes zoom { from{transform:scale(1)} to{transform:scale(1.1)} }
  .hero-overlay {
    position: absolute; inset: 0; background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
    display: flex; flex-direction: column; justify-content: flex-end; padding: 20px; color: white;
  }

  /* --- SEARCH & CHIPS --- */
  .search-wrapper { position: relative; margin-bottom: 15px; }
  .search-box {
    background: white; padding: 14px 16px 14px 45px; border-radius: 18px; width: 100%;
    border: 1px solid transparent; box-shadow: var(--shadow-soft); font-size: 15px; font-weight: 500;
    transition: 0.3s;
  }
  .search-box:focus { border-color: var(--primary); outline: none; box-shadow: 0 5px 20px rgba(255, 75, 58, 0.15); }
  .search-icon { position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: #888; font-size: 20px; }

  .chips { display: flex; gap: 10px; overflow-x: auto; padding-bottom: 5px; scrollbar-width: none; margin-bottom: 20px; }
  .chip {
    padding: 10px 20px; border-radius: 40px; background: white; border: 1px solid #eee;
    font-size: 13px; font-weight: 600; color: #666; white-space: nowrap; transition: 0.2s; cursor: pointer;
  }
  .chip.active { background: var(--dark); color: white; border-color: var(--dark); box-shadow: 0 5px 15px rgba(0,0,0,0.2); }

  /* --- STORES & CARDS --- */
  .shop-section { margin-bottom: 30px; animation: fadeInUp 0.5s ease; }
  .shop-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; padding: 0 5px; }
  .shop-name { font-size: 19px; font-weight: 800; }
  .status-badge { font-size: 10px; padding: 5px 12px; border-radius: 20px; font-weight: 800; color: white; text-transform: uppercase; }
  .status-badge.online { background: #00b894; box-shadow: 0 4px 10px rgba(0, 184, 148, 0.3); }
  .status-badge.offline { background: #ff7675; opacity: 0.8; }

  .h-scroll { display: flex; gap: 15px; overflow-x: auto; padding: 5px 5px 25px; scrollbar-width: none; }
  
  .card {
    min-width: 210px; background: white; border-radius: 24px; padding: 10px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.06); position: relative; transition: 0.2s;
  }
  .card:active { transform: scale(0.97); }
  .card.offline { filter: grayscale(1); opacity: 0.7; pointer-events: none; }

  .card img { width: 100%; height: 130px; object-fit: cover; border-radius: 18px; background: #eee; margin-bottom: 10px; }
  
  .card-body { padding: 0 5px 5px; }
  .card-title { font-size: 16px; font-weight: 700; margin-bottom: 5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
  
  .variant-select {
    width: 100%; padding: 8px; border-radius: 10px; border: 1px solid #eee;
    font-size: 12px; margin-bottom: 10px; background: #f9f9f9; outline: none; font-weight: 500;
  }
  
  .card-footer { display: flex; justify-content: space-between; align-items: center; }
  .price { font-size: 17px; font-weight: 800; color: var(--dark); }
  .add-btn {
    width: 38px; height: 38px; background: var(--dark); color: white; border-radius: 12px;
    display: flex; justify-content: center; align-items: center; border: none; font-size: 20px; cursor: pointer;
    box-shadow: 0 5px 15px rgba(0,0,0,0.2); transition: 0.2s;
  }
  .add-btn:active { transform: scale(0.8); background: var(--primary); }

  /* --- FLOATING UI --- */
  .fab-cart {
    position: fixed; bottom: 95px; right: 20px; background: var(--dark); color: white;
    padding: 14px 24px; border-radius: 40px; font-weight: 700; box-shadow: 0 15px 35px rgba(0,0,0,0.25);
    display: flex; align-items: center; gap: 10px; z-index: 90; transition: 0.3s;
    cursor: pointer; transform: translateY(100px); opacity: 0;
  }
  .fab-cart.visible { transform: translateY(0); opacity: 1; }

  .fab-ai {
    position: fixed; bottom: 25px; right: 20px; width: 64px; height: 64px;
    background: linear-gradient(135deg, #FF4B3A, #FF7F50); color: white;
    border-radius: 50%; display: flex; justify-content: center; align-items: center;
    font-size: 30px; box-shadow: 0 10px 30px rgba(255, 75, 58, 0.4); z-index: 95;
    border: none; animation: float 3s ease-in-out infinite; cursor: pointer;
  }
  @keyframes float { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-6px)} }

  /* --- MODALS (GLASS) --- */
  .modal-overlay {
    position: fixed; inset: 0; background: rgba(0,0,0,0.5); backdrop-filter: blur(6px);
    z-index: 200; display: none; align-items: flex-end; opacity: 0; transition: opacity 0.3s;
  }
  .modal-overlay.show { display: flex; opacity: 1; }

  .modal-card {
    background: white; width: 100%; border-radius: 30px 30px 0 0; padding: 25px;
    box-shadow: 0 -10px 40px rgba(0,0,0,0.15); transform: translateY(100%); transition: transform 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
    max-height: 85vh; display: flex; flex-direction: column;
  }
  .modal-overlay.show .modal-card { transform: translateY(0); }

  /* AI Special Style */
  .ai-card {
    background: rgba(255, 255, 255, 0.95);
    border-top: 1px solid rgba(255,255,255,0.5);
  }
  .ai-bubble {
    background: #f0f0f5; padding: 16px; border-radius: 18px 18px 18px 4px;
    margin: 15px 0; font-size: 15px; line-height: 1.5; color: #333; font-weight: 500;
    box-shadow: inset 0 2px 5px rgba(0,0,0,0.03);
  }
  
  .input-group { display: flex; gap: 10px; margin-top: 10px; }
  .input-group input {
    flex: 1; padding: 14px 18px; border-radius: 14px; border: 1px solid #ddd; outline: none; font-size: 15px;
  }
  .send-btn {
    width: 50px; border-radius: 14px; border: none; background: var(--dark); color: white; font-size: 20px; cursor: pointer;
  }

  /* Cart Items */
  .cart-list { overflow-y: auto; flex: 1; margin-bottom: 15px; }
  .cart-item { display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid #f4f4f4; }
  .qty-ctrl { display: flex; align-items: center; gap: 12px; background: #f4f4f8; padding: 6px 12px; border-radius: 12px; font-weight: 700; }
  
  .bill-box { background: #f9f9fb; padding: 15px; border-radius: 18px; border: 1px dashed #ddd; margin-bottom: 15px; }
  .bill-row { display: flex; justify-content: space-between; margin-bottom: 5px; font-size: 14px; color: #666; }
  .bill-total { display: flex; justify-content: space-between; margin-top: 10px; font-size: 18px; font-weight: 800; color: var(--dark); }

  .checkout-btn {
    width: 100%; padding: 16px; background: #2ed573; color: white; border: none;
    border-radius: 16px; font-size: 16px; font-weight: 700; cursor: pointer;
    box-shadow: 0 8px 20px rgba(46, 213, 115, 0.3); transition: 0.2s;
  }
  .checkout-btn:active { transform: scale(0.98); }

  /* --- TOAST & SPARK --- */
  .toast {
    position: fixed; top: 100px; left: 50%; transform: translateX(-50%) scale(0.9);
    background: rgba(15, 15, 15, 0.9); backdrop-filter: blur(5px); color: white;
    padding: 12px 24px; border-radius: 40px; font-size: 14px; font-weight: 600;
    opacity: 0; pointer-events: none; transition: 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); z-index: 300;
    display: flex; align-items: center; gap: 8px; box-shadow: 0 10px 30px rgba(0,0,0,0.2);
  }
  .toast.show { transform: translateX(-50%) scale(1); opacity: 1; }

  .spark {
    position: fixed; pointer-events: none; width: 20px; height: 20px;
    background: radial-gradient(circle, #FFD700, transparent); border-radius: 50%;
    transform: scale(0); z-index: 300;
  }
  .spark.active { animation: pop 0.6s ease-out; }
  @keyframes pop { 0%{transform:scale(0); opacity:1;} 50%{opacity:1} 100%{transform:scale(4); opacity:0;} }
  @keyframes fadeInUp { from{opacity:0; transform:translateY(20px);} to{opacity:1; transform:translateY(0);} }

</style>
</head>

<body>

  <div class="header">
    <div class="logo">SAN<span>GHX</span></div>
    <a href="https://wa.me/918087762813" target="_blank" style="color:var(--dark); font-size:26px;"><i class='bx bxl-whatsapp'></i></a>
  </div>

  <div class="ticker-wrap">
    <div class="ticker">
      <span>‚ö° SANGHX = fast ‚Ä¢ local ‚Ä¢ savage üòàüî•</span>
      <span>‚ö° ‡§Ü‡§ú ‡§ï‡§æ‡§Ø ‡§ñ‡§æ‡§Ø‡§ö‡§Ç? AI ‡§≤‡§æ ‡§µ‡§ø‡§ö‡§æ‡§∞ ‡§≠‡§æ‡§µ‡§æ üò≠üòÇ</span>
      <span>‚ö° ‡§Ü‡§Ø‡•Å‡§∑‡•ç‡§Ø‡§æ‡§§ ‡§™‡•à‡§∂‡§æ‡§™‡•á‡§ï‡•ç‡§∑‡§æ ‡§µ‡§ø‡§∂‡•ç‡§µ‡§æ‡§∏ ‡§ú‡§æ‡§∏‡•ç‡§§ ‡§Æ‡§π‡§§‡•ç‡§§‡•ç‡§µ‡§æ‡§ö‡§æ ‡§Ü‡§π‡•á ‡§≠‡§æ‡§µ‡§æ ‚ù§Ô∏è</span>
    </div>
  </div>

  <div class="container">
    <!-- HERO AUTO SLIDER -->
    <div class="hero-banner" id="heroSlider">
      <img id="heroImg" src="https://images.unsplash.com/photo-1555939594-58d7cb561ad1?q=80&w=800&auto=format&fit=crop" class="hero-img">
      <div class="hero-overlay">
        <h2 style="font-weight:800; font-size:28px; line-height:1;">Delicious<br>Deals 50% OFF</h2>
      </div>
    </div>

    <div class="search-wrapper">
      <i class='bx bx-search search-icon'></i>
      <input class="search-box" id="searchInput" placeholder="Search biryani, pizza, rolls...">
    </div>
    
    <div class="chips" id="categoryChips">
      <div class="chip active">All</div>
    </div>

    <div id="storesWrap"></div>
  </div>

  <div class="fab-cart" id="miniCartBtn">
    <i class='bx bxs-shopping-bag' style="font-size:20px;"></i> 
    <span id="cartCount">0</span>
  </div>

  <button class="fab-ai" id="aiBtn"><i class='bx bx-bot'></i></button>

  <div class="modal-overlay" id="cartModalBg">
    <div class="modal-card">
      <div style="display:flex; justify-content:space-between; margin-bottom:20px; align-items:center;">
        <h2 style="font-weight:800;">Your Cart üõí</h2>
        <i class='bx bx-x' style="font-size:28px; padding:8px; background:#f4f4f8; border-radius:50%; cursor:pointer;" id="closeCartBtn"></i>
      </div>
      
      <div class="cart-list" id="cartItems"></div>
      
      <div class="bill-box">
        <div class="bill-row"><span>Subtotal</span> <span id="subtotal">‚Çπ0</span></div>
        <div class="bill-row"><span>Delivery</span> <span>‚Çπ10</span></div>
        <div class="bill-total"><span>Total</span> <span id="total">‚Çπ0</span></div>
      </div>
      
      <button class="checkout-btn" id="checkoutBtn">Checkout Now <i class='bx bx-right-arrow-alt'></i></button>
    </div>
  </div>

  <div class="modal-overlay" id="aiPanelBg">
    <div class="modal-card ai-card">
      <div style="display:flex; justify-content:space-between; align-items:center;">
        <div style="display:flex; align-items:center; gap:12px;">
          <div style="width:45px; height:45px; background:var(--dark); color:white; border-radius:50%; display:flex; justify-content:center; align-items:center; font-size:24px;"><i class='bx bx-bot'></i></div>
          <div>
            <b style="display:block; font-size:16px;">BroAI</b>
            <small style="color:var(--primary); font-weight:700; font-size:11px;">MARATHI MODE üáÆüá≥</small>
          </div>
        </div>
        <i class='bx bx-x' id="aiCloseBtn" style="font-size:28px; padding:5px; cursor:pointer;"></i>
      </div>

      <div class="ai-bubble" id="aiLine">
        ‡§≠‡§æ‡§µ‡§æ‚Ä¶ ‡§Æ‡•Ä ‡§§‡§Ø‡§æ‡§∞ ‡§Ü‡§π‡•á üòàüî• ‚Äú‡§≠‡•Ç‡§ï ‡§≤‡§æ‡§ó‡§≤‡•Ä‚Äù ‡§Ö‡§∏‡§Ç ‡§ü‡§æ‡§à‡§™ ‡§ï‡§∞!
      </div>

      <div class="input-group">
        <input id="aiInput" placeholder="Ask me (e.g. Best combo?)...">
        <button class="send-btn" id="aiSendBtn"><i class='bx bxs-send'></i></button>
      </div>
    </div>
  </div>

  <div id="toast" class="toast"><i class='bx bxs-check-circle' style="color:#2ed573; font-size:18px;"></i> <span>Added to cart</span></div>
  <div id="spark" class="spark"></div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getFirestore, collection, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

  const firebaseConfig = { apiKey: "AIzaSyC-igyzVwdH_4Jt1r64TtHSfYxIMw8UfzM", projectId: "sanghx-foods" };
  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  let STORES = [], MENU = [], ACTIVE_CATEGORY = "All", SEARCH = "";
  let cart = JSON.parse(localStorage.getItem("cart")) || [];

  // Elements
  const els = {
    stores: document.getElementById("storesWrap"),
    chips: document.getElementById("categoryChips"),
    search: document.getElementById("searchInput"),
    miniCart: document.getElementById("miniCartBtn"),
    cartModal: document.getElementById("cartModalBg"),
    cartItems: document.getElementById("cartItems"),
    aiModal: document.getElementById("aiPanelBg"),
    aiLine: document.getElementById("aiLine"),
    aiInput: document.getElementById("aiInput"),
    toast: document.getElementById("toast"),
    spark: document.getElementById("spark")
  };

  // --- HERO AUTO SLIDER ---
  const heroImages = [
    "https://images.unsplash.com/photo-1555939594-58d7cb561ad1?q=80&w=800&auto=format&fit=crop",
    "https://images.unsplash.com/photo-1540189549336-e6e99c3679fe?q=80&w=800&auto=format&fit=crop",
    "https://images.unsplash.com/photo-1565299624946-b28f40a0ae38?q=80&w=800&auto=format&fit=crop",
    "https://images.unsplash.com/photo-1604908176997-125f25cc500f?q=80&w=800&auto=format&fit=crop"
  ];

  let heroIndex = 0;
  const heroImgEl = document.getElementById("heroImg");

  setInterval(() => {
    heroIndex = (heroIndex + 1) % heroImages.length;

    heroImgEl.style.opacity = "0";
    setTimeout(() => {
      heroImgEl.src = heroImages[heroIndex];
      heroImgEl.style.opacity = "1";
    }, 250);
  }, 3000);

  // --- 1. VOICE ENGINE (Hindi/Marathi Fix) ---
  let selectedVoice = null;
  function loadVoices() {
    const voices = window.speechSynthesis.getVoices();
    selectedVoice = voices.find(v => v.lang.includes('hi-IN')) || 
                    voices.find(v => v.lang.includes('mr-IN')) || 
                    voices.find(v => v.lang.includes('en-IN')) || 
                    voices[0];
  }
  if (window.speechSynthesis.onvoiceschanged !== undefined) {
    window.speechSynthesis.onvoiceschanged = loadVoices;
  }
  loadVoices(); 

  function speak(text) {
    if (!('speechSynthesis' in window)) return;
    window.speechSynthesis.cancel();
    const u = new SpeechSynthesisUtterance(text);
    if(selectedVoice) u.voice = selectedVoice;
    u.rate = 1; u.pitch = 1;
    window.speechSynthesis.speak(u);
  }

  // --- 2. RENDER STORES & MENU ---
  function safe(str) { return String(str||"").replace(/</g,"&lt;"); }

  function renderCategoryChips() {
    const cats = ["All", ...new Set(MENU.map(m => m.category).filter(Boolean))];
    els.chips.innerHTML = cats.map(c => 
      `<div class="chip ${ACTIVE_CATEGORY===c?'active':''}" onclick="setCat('${c}')">${c}</div>`
    ).join("");
  }
  window.setCat = (c) => { ACTIVE_CATEGORY = c; renderCategoryChips(); renderStores(); };

  function renderStores() {
    els.stores.innerHTML = "";
    if(STORES.length === 0) { els.stores.innerHTML = "<div style='text-align:center;padding:40px;color:#aaa'>Loading Stores...</div>"; return; }

    STORES.forEach(store => {
      const items = MENU.filter(m => 
        (m.storeName === store.name) &&
        (ACTIVE_CATEGORY==="All" || m.category===ACTIVE_CATEGORY) &&
        (m.name.toLowerCase().includes(SEARCH) || store.name.toLowerCase().includes(SEARCH))
      );

      if(items.length === 0 && SEARCH) return; 

      const section = document.createElement("div");
      section.className = "shop-section";
      section.innerHTML = `
        <div class="shop-header">
          <div class="shop-name">${safe(store.name)}</div>
          <div class="status-badge ${store.isOnline?'online':'offline'}">
            ${store.isOnline ? 'Open Now' : 'Closed'}
          </div>
        </div>
        <div class="h-scroll" id="list-${store.id}"></div>
      `;
      
      const list = section.querySelector(".h-scroll");
      if(items.length === 0) list.innerHTML = "<div style='font-size:13px;color:#aaa;padding:10px;'>No items found here</div>";
      
      items.forEach(item => {
        const variants = item.variants || [{label:"Regular", price:item.price}];
        const div = document.createElement("div");
        div.className = `card ${store.isOnline?'':'offline'}`;
        
        let opts = variants.map((v,i) => `<option value="${i}">${v.label} - ‚Çπ${v.price}</option>`).join('');

        div.innerHTML = `
          <img src="${item.img}" onerror="this.src='https://via.placeholder.com/150'">
          <div class="card-body">
            <div class="card-title">${safe(item.name)}</div>
            <select class="variant-select">${opts}</select>
            <div class="card-footer">
              <div class="price">‚Çπ<span class="p-val">${variants[0].price}</span></div>
              <button class="add-btn"><i class='bx bx-plus'></i></button>
            </div>
          </div>
        `;
        
        const sel = div.querySelector("select");
        const pVal = div.querySelector(".p-val");
        sel.onchange = () => pVal.innerText = variants[sel.value].price;
        
        div.querySelector(".add-btn").onclick = (e) => {
          if(!store.isOnline) return;
          const v = variants[sel.value];
          addToCart(item, store.name, v.label, v.price);
          animateSpark(e.clientX, e.clientY);
        };
        
        list.appendChild(div);
      });
      els.stores.appendChild(section);
    });
  }

  // --- 3. CART SYSTEM ---
  function addToCart(item, storeName, variant, price) {
    const key = `${item.id}-${variant}`;
    const exist = cart.find(x => x.key === key);
    if(exist) exist.qty++;
    else cart.push({ key, id:item.id, name:item.name, storeName, variant, price, qty:1 });
    
    saveCart();
    speak(`${item.name} added`);
    showToast(`Added ${item.name}`);
  }

  function updateQty(key, delta) {
    const i = cart.find(x => x.key === key);
    if(!i) return;
    i.qty += delta;
    if(i.qty <= 0) cart = cart.filter(x => x.key !== key);
    saveCart();
  }

  function saveCart() {
    localStorage.setItem("cart", JSON.stringify(cart));
    renderCart();
  }

  function renderCart() {
    const totalQty = cart.reduce((a,b)=>a+b.qty,0);
    els.miniCart.classList.toggle("visible", totalQty > 0);
    document.getElementById("cartCount").innerText = totalQty;

    els.cartItems.innerHTML = cart.map(i => `
      <div class="cart-item">
        <div>
          <div style="font-weight:700; font-size:15px;">${safe(i.name)}</div>
          <div style="font-size:12px;color:#888;">${safe(i.variant)} ‚Ä¢ ‚Çπ${i.price}</div>
        </div>
        <div class="qty-ctrl">
          <i class='bx bx-minus' onclick="window.upd('${i.key}',-1)" style="cursor:pointer"></i>
          <span>${i.qty}</span>
          <i class='bx bx-plus' onclick="window.upd('${i.key}',1)" style="cursor:pointer"></i>
        </div>
      </div>
    `).join("");
    window.upd = updateQty;

    const sub = cart.reduce((a,b)=>a+(b.price*b.qty),0);
    document.getElementById("subtotal").innerText = `‚Çπ${sub}`;
    document.getElementById("total").innerText = `‚Çπ${sub + (cart.length?10:0)}`;
  }

  // --- 4. BroAI BRAIN ---
  function broAIReply(msg) {
    msg = msg.toLowerCase();
    if(msg.includes('bhuk') || msg.includes('hungry')) return "‡§≠‡•Ç‡§ï ‡§≤‡§æ‡§ó‡§≤‡•Ä‡§Ø‡•á? ‡§Æ‡§ó ‡§®‡•Å‡§∏‡§§‡§Ç ‡§¨‡§ò‡§§ ‡§¨‡§∏‡•Ç ‡§®‡§ï‡•ã‡§∏ üò≠üî• Jalebi + Roll combo ‡§ü‡§æ‡§ï cart ‡§Æ‡§ß‡•ç‡§Ø‡•á!";
    if(msg.includes('recommend') || msg.includes('best')) return "Chicken Roll try ‡§ï‡§∞‚Ä¶ ‡§ï‡§æ‡§∞‡§£ ‡§§‡•Å‡§ù‡§Ç ‡§Ü‡§Ø‡•Å‡§∑‡•ç‡§Ø‡§π‡•Ä ‡§ó‡•ã‡§° ‡§Ü‡§£‡§ø spicy ‡§¶‡•ã‡§®‡•ç‡§π‡•Ä ‡§Ü‡§π‡•á üòÇüî•";
    if(msg.includes('cheap') || msg.includes('budget')) return "Budget ‡§Æ‡§ß‡•ç‡§Ø‡•á? ‡§≠‡§æ‡§µ‡§æ delivery ‡§´‡§ï‡•ç‡§§ ‚Çπ10‚Ä¶ ‡§¨‡§æ‡§ï‡•Ä ‡§§‡•Ç ‡§∞‡§æ‡§ú‡§æ ‡§Ü‡§π‡•á‡§∏ üò≠üëë";
    if(msg.includes('cart')) return cart.length ? `Cart ‡§Æ‡§ß‡•ç‡§Ø‡•á ${cart.length} items ‡§Ü‡§π‡•á‡§§. ‡§Ü‡§§‡§æ order ‡§ï‡§∞!` : "Cart ‡§∞‡§ø‡§ï‡§æ‡§Æ‡§æ ‡§Ü‡§π‡•á, diet ‡§µ‡§∞ ‡§Ü‡§π‡•á‡§∏ ‡§ï‡§æ? üòÇ";
    return "‡§≠‡§æ‡§µ‡§æ‚Ä¶ ‡§§‡•Ç ‡§µ‡§ø‡§ö‡§æ‡§∞‡§§‡•ã‡§Ø‡§∏ ‡§™‡§£ order ‡§ï‡§∞‡§§ ‡§®‡§æ‡§π‡•Ä‡§∏. Order kar jaldi üò≠üòÇ";
  }

  document.getElementById("aiSendBtn").onclick = () => {
    const txt = els.aiInput.value.trim();
    if(!txt) return;
    const ans = broAIReply(txt);
    els.aiLine.innerText = ans;
    speak(ans);
    els.aiInput.value = "";
  };

  // --- 5. EVENTS ---
  els.search.oninput = (e) => { SEARCH = e.target.value.toLowerCase(); renderStores(); };
  
  els.miniCart.onclick = () => els.cartModal.classList.add("show");
  document.getElementById("closeCartBtn").onclick = () => els.cartModal.classList.remove("show");
  document.getElementById("checkoutBtn").onclick = () => location.href = "checkout.html";
  
  document.getElementById("aiBtn").onclick = () => {
    els.aiModal.classList.add("show");
    speak("‡§≠‡§æ‡§µ‡§æ, ‡§Æ‡•Ä BroAI ‡§Ü‡§π‡•á. ‡§ï‡§æ‡§Ø ‡§ë‡§∞‡•ç‡§°‡§∞ ‡§ï‡§∞‡§æ‡§Ø‡§ö‡§Ç?");
  };
  document.getElementById("aiCloseBtn").onclick = () => els.aiModal.classList.remove("show");

  function showToast(msg) {
    els.toast.innerHTML = `<i class='bx bxs-check-circle' style="color:#2ed573; font-size:18px;"></i> <span>${msg}</span>`;
    els.toast.classList.add("show");
    setTimeout(() => els.toast.classList.remove("show"), 2000);
  }
  
  function animateSpark(x, y) {
    els.spark.style.left = (x-10)+"px"; els.spark.style.top = (y-10)+"px";
    els.spark.classList.remove("active");
    void els.spark.offsetWidth; 
    els.spark.classList.add("active");
  }

  // --- 6. FIRESTORE SYNC ---
  onSnapshot(collection(db, "stores"), sn => {
    STORES = []; sn.forEach(d => STORES.push({id:d.id, ...d.data()}));
    renderStores();
  });
  onSnapshot(collection(db, "menu"), sn => {
    MENU = []; sn.forEach(d => MENU.push({id:d.id, ...d.data()}));
    renderCategoryChips(); renderStores();
  });

  renderCart();
</script>
</body>
</html>
